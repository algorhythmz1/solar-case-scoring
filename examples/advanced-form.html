<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced Solar Qualification Form</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 700px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      padding: 40px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    }

    h2 {
      margin-bottom: 10px;
      color: #333;
    }

    .subtitle {
      color: #666;
      margin-bottom: 30px;
    }

    .progress-bar {
      height: 4px;
      background: #e0e0e0;
      border-radius: 2px;
      margin-bottom: 30px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea, #764ba2);
      width: 0%;
      transition: width 0.3s;
    }

    .form-group {
      margin-bottom: 24px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"],
    select {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 6px;
      font-size: 15px;
      transition: border-color 0.3s;
    }

    input:focus,
    select:focus {
      outline: none;
      border-color: #667eea;
    }

    .radio-group {
      display: flex;
      gap: 15px;
    }

    .radio-option {
      flex: 1;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 6px;
      cursor: pointer;
      text-align: center;
      transition: all 0.3s;
    }

    .radio-option:hover {
      border-color: #667eea;
      background: #f8f9ff;
    }

    .radio-option input {
      display: none;
    }

    .radio-option input:checked + span {
      color: #667eea;
      font-weight: 600;
    }

    .radio-option.selected {
      border-color: #667eea;
      background: #f8f9ff;
    }

    button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 14px 30px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      transition: transform 0.2s;
    }

    button:hover {
      transform: translateY(-2px);
    }

    .score-display {
      display: none;
      margin-top: 30px;
      padding: 20px;
      border-radius: 8px;
      background: #f8f9fa;
    }

    .score-header {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 15px;
    }

    .score-breakdown {
      margin: 15px 0;
    }

    .score-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #e0e0e0;
    }

    .score-total {
      font-size: 20px;
      font-weight: bold;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 2px solid #333;
    }

    .qualified {
      color: #10b981;
    }

    .unqualified {
      color: #dc2626;
    }

    .analytics {
      margin-top: 20px;
      padding: 15px;
      background: white;
      border-radius: 6px;
      font-size: 14px;
    }

    .tag-preview {
      display: inline-block;
      padding: 4px 12px;
      background: #667eea;
      color: white;
      border-radius: 4px;
      font-size: 12px;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<div class="container">
  <h2>Advanced Solar Qualification</h2>
  <p class="subtitle">Example with progress tracking, score breakdown, and analytics</p>

  <div class="progress-bar">
    <div class="progress-fill" id="progressFill"></div>
  </div>

  <form id="advancedForm">
    <div class="form-group">
      <label>Full Name *</label>
      <input type="text" id="name" required>
    </div>

    <div class="form-group">
      <label>Email Address *</label>
      <input type="email" id="email" required>
    </div>

    <div class="form-group">
      <label>Phone Number *</label>
      <input type="tel" id="phone" required>
    </div>

    <div class="form-group">
      <label>Are you paying MORE for electricity after going solar? *</label>
      <div class="radio-group">
        <label class="radio-option">
          <input type="radio" name="payingMore" value="yes" required>
          <span>Yes</span>
        </label>
        <label class="radio-option">
          <input type="radio" name="payingMore" value="no">
          <span>No</span>
        </label>
      </div>
    </div>

    <div class="form-group">
      <label>Are your solar panels shaded at any part of the day? *</label>
      <div class="radio-group">
        <label class="radio-option">
          <input type="radio" name="shade" value="yes" required>
          <span>Yes</span>
        </label>
        <label class="radio-option">
          <input type="radio" name="shade" value="no">
          <span>No</span>
        </label>
      </div>
    </div>

    <div class="form-group">
      <label>Is the inverter mounted on the outside of your house? *</label>
      <div class="radio-group">
        <label class="radio-option">
          <input type="radio" name="inverter" value="yes" required>
          <span>Yes</span>
        </label>
        <label class="radio-option">
          <input type="radio" name="inverter" value="no">
          <span>No</span>
        </label>
      </div>
    </div>

    <button type="submit">Calculate Qualification Score</button>
  </form>

  <div class="score-display" id="scoreDisplay">
    <div class="score-header" id="scoreHeader"></div>
    <div class="score-breakdown" id="scoreBreakdown"></div>
    <div class="score-total" id="scoreTotal"></div>
    <div class="analytics" id="analytics"></div>
  </div>
</div>

<script>
  // Configuration
  const CONFIG = {
    scoring: {
      payingMore: 50,
      shade: 30,
      inverter: 20,
      threshold: 60
    },
    tags: {
      qualified: 'good_solar_case',
      unqualified: 'low_quality_case'
    }
  };

  // Track form progress
  const inputs = document.querySelectorAll('input[required]');
  const totalFields = inputs.length;

  function updateProgress() {
    let filled = 0;
    inputs.forEach(input => {
      if (input.type === 'radio') {
        if (document.querySelector(`input[name="${input.name}"]:checked`)) {
          filled++;
        }
      } else if (input.value.trim() !== '') {
        filled++;
      }
    });

    // Remove duplicates for radio groups
    const radioGroups = new Set();
    document.querySelectorAll('input[type="radio"]:checked').forEach(radio => {
      radioGroups.add(radio.name);
    });

    filled = document.querySelectorAll('input[type="text"]:not(:placeholder-shown), input[type="email"]:not(:placeholder-shown), input[type="tel"]:not(:placeholder-shown)').length + radioGroups.size;

    const progress = (filled / totalFields) * 100;
    document.getElementById('progressFill').style.width = progress + '%';
  }

  // Radio button styling
  document.querySelectorAll('.radio-option').forEach(option => {
    option.addEventListener('click', function() {
      const input = this.querySelector('input');
      input.checked = true;

      // Remove selected class from siblings
      this.parentElement.querySelectorAll('.radio-option').forEach(opt => {
        opt.classList.remove('selected');
      });

      // Add selected class to this option
      this.classList.add('selected');

      updateProgress();
    });
  });

  // Track input changes
  inputs.forEach(input => {
    input.addEventListener('input', updateProgress);
    input.addEventListener('change', updateProgress);
  });

  // Phone formatting
  document.getElementById('phone').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    if (value.length > 0) {
      if (value.length <= 3) {
        value = `(${value}`;
      } else if (value.length <= 6) {
        value = `(${value.slice(0, 3)}) ${value.slice(3)}`;
      } else {
        value = `(${value.slice(0, 3)}) ${value.slice(3, 6)}-${value.slice(6, 10)}`;
      }
    }
    e.target.value = value;
  });

  // Form submission
  document.getElementById('advancedForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const formData = {
      name: document.getElementById('name').value,
      email: document.getElementById('email').value,
      phone: document.getElementById('phone').value,
      payingMore: document.querySelector('input[name="payingMore"]:checked').value,
      shade: document.querySelector('input[name="shade"]:checked').value,
      inverter: document.querySelector('input[name="inverter"]:checked').value
    };

    // Calculate score
    const breakdown = [];
    let score = 0;

    if (formData.payingMore === 'yes') {
      score += CONFIG.scoring.payingMore;
      breakdown.push({ question: 'Paying more for electricity', points: CONFIG.scoring.payingMore });
    }

    if (formData.shade === 'yes') {
      score += CONFIG.scoring.shade;
      breakdown.push({ question: 'Panels are shaded', points: CONFIG.scoring.shade });
    }

    if (formData.inverter === 'yes') {
      score += CONFIG.scoring.inverter;
      breakdown.push({ question: 'Inverter mounted outside', points: CONFIG.scoring.inverter });
    }

    const qualified = score >= CONFIG.scoring.threshold;
    const tag = qualified ? CONFIG.tags.qualified : CONFIG.tags.unqualified;

    // Display results
    const scoreDisplay = document.getElementById('scoreDisplay');
    scoreDisplay.style.display = 'block';

    document.getElementById('scoreHeader').innerHTML = `
      <span class="${qualified ? 'qualified' : 'unqualified'}">
        ${qualified ? '✓ QUALIFIED' : '✗ NOT QUALIFIED'}
      </span>
    `;

    let breakdownHTML = '<strong>Score Breakdown:</strong>';
    breakdown.forEach(item => {
      breakdownHTML += `
        <div class="score-item">
          <span>${item.question}</span>
          <span>+${item.points} points</span>
        </div>
      `;
    });

    if (breakdown.length === 0) {
      breakdownHTML += '<div class="score-item"><span>No qualifying factors</span><span>0 points</span></div>';
    }

    document.getElementById('scoreBreakdown').innerHTML = breakdownHTML;

    document.getElementById('scoreTotal').innerHTML = `
      <div class="score-item">
        <span>Total Score</span>
        <span>${score} / ${CONFIG.scoring.threshold} points</span>
      </div>
    `;

    document.getElementById('analytics').innerHTML = `
      <strong>Lead Information:</strong><br>
      Name: ${formData.name}<br>
      Email: ${formData.email}<br>
      Phone: ${formData.phone}<br>
      <strong>Routing Tag:</strong> <span class="tag-preview">${tag}</span><br>
      <br>
      <small>In production, this data would be sent to GoHighLevel via API.</small>
    `;

    // Scroll to results
    scoreDisplay.scrollIntoView({ behavior: 'smooth', block: 'nearest' });

    // Log to console
    console.log('Qualification Results:', {
      formData,
      score,
      breakdown,
      qualified,
      tag,
      timestamp: new Date().toISOString()
    });
  });
</script>

</body>
</html>
